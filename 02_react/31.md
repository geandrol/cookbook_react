<h1>Projeto Blog Pessoal - Ajustes Finais</h1>

Chegando agora ao final do nosso projeto, voc칡 deve ter percebido que algumas coisas ainda precisam serem finalizadas, no caso, estamos nos referindo aos componentes Navbar e Footer, que aparecem independente se o usu치rio est치 ou n칚o logado na aplica칞칚o, e tamb칠m a quest칚o dos alertas da aplica칞칚o, onde usamos os alertas padr칫es do nosso navegador.

Para manipular a exibi칞칚o do Navbar e do Footer, usaremos uma **Renderiza칞칚o Condicional** - descrita no CookBook Introdu칞칚o a Props, Hooks e Renderiza칞칚o Condicional - e para personalizarmos os alertas, **instalaremos a biblioteca React-Toastify**.

<h2><img src="https://i.imgur.com/H9wEgsJ.png" title="source: imgur.com" width="5%"/>Passo 01 - Alterando a l칩gica de exibi칞칚o do Componente Navbar</h2>

1. Abra o Componente Navbar, localizado na pasta **components**.
2. Na sequ칡ncia, adicione os seguintes c칩digos:

```tsx
import { ReactNode, useContext } from 'react'
import { Link, useNavigate } from 'react-router-dom'

import { AuthContext } from '../../contexts/AuthContext'

function Navbar() {

    const navigate = useNavigate()
    const { usuario, handleLogout } = useContext(AuthContext)

    function logout() {
        handleLogout()
        alert('Usu치rio deslogado com sucesso')
        navigate('/login')
    }

    let component: ReactNode

    if (usuario.token !== "") {

        component = (
            <div className='w-full bg-indigo-900 text-white flex justify-center py-4'>
                <div className=" container flex justify-between text-lg">
                    <Link to='/home' className='text-2xl font-bold'>Blog Pessoal</Link>

                    <div className='flex gap-4'>
                        <Link to='/postagens' className='hover:underline'>Postagens</Link>
                        <Link to='/temas' className='hover:underline'>Temas</Link>
                        <Link to='/cadastroTema' className='hover:underline'>Cadastrar Tema</Link>
                        <Link to='/perfil' className='hover:underline'>Perfil</Link>
                        <Link to='' onClick={logout} className='hover:underline'>Sair</Link>
                    </div>

                </div>
            </div>
        )

    }

    return (
        <>
            { component }
        </>
    )
}

export default Navbar
```

<br>

<div align="center"><img src="https://i.imgur.com/LnUKYPJ.png" title="source: imgur.com" /></div>

<br>

**Vamos analisar as altera칞칫es efetuadas no c칩digo:**

**Linha 01:** Fazemos a importa칞칚o da tipagem ReactNode da biblitoeca do react.

**Linha 09:** Importamos do Contexto o estado do usu치rios.

**Linha 17:** Adicionamos uma **vari치vel let chamada component**, que ser치 do tipo **ReactNode**, indicando que o valor desta vari치vel armazenar치 algo que possa ser renderizado pelo React. 

<br>

<div align="center"><img src="https://i.imgur.com/7LRxwgc.png" title="source: imgur.com" /></div>

<br>

**Linhas 19 a 38:** Adicionamos uma estrutura condicional **IF**, onde verificamos se o o token do estado usu치rio 칠 diferente de uma String vazia. Se esta condi칞칚o for verdadeira, isso indica que o usu치rio est치 logado.

**Linhas 21 a 36:** Se o usu치rio estiver logado, atualizamos a vari치vel componente com a estrutura do componente navbar, isto 칠, ao inv칠s de retornamos diretamente o que deve ser exibido em tela, passamos o c칩digo HTML/CSS do Navbar para uma vari치vel.

<br>

<div align="center"><img src="https://i.imgur.com/TDeiWqX.png" title="source: imgur.com" /></div>

<br>

**Linhas 40 a 44:** Onde antes estava o c칩digo de exibi칞칚o do Navbar, agora consta a vari치vel **component**. 

A l칩gica que empregamos nesse componente se d치 da seguinte maneira: Quando o token de usu치rio estiver preenchido apenas com uma String vazia, isso indica que o usu치rio ainda n칚o fez o login na aplica칞칚o. Com isso, o componente Navbar, ir치 exibida o conte칰do inicial da vari치vel componente, ou seja, nada.

A partir do momento que o token for preenchido, nossa estrutura condicional ir치 atualizar a vari치vel **component** com os c칩digos do nosso Navbar, e com isso, o mesmo ser치 exibido, dando as op칞칫es de navega칞칚o ao usu치rio.

<h2><img src="https://i.imgur.com/H9wEgsJ.png" title="source: imgur.com" width="5%"/>Passo 02 - Alterando a l칩gica de exibi칞칚o do Componente Footer</h2>

Da mesma maneira que alteramos a exibi칞칚o do Navbar, iremos aplicar a mesma l칩gica ao Footer. Portanto siga os passos abaixo:

1. Abra o Componente Footer, localizado na pasta **components**.
2. Na sequ칡ncia, adicione os seguintes c칩digos:

```tsx
import { ReactNode, useContext } from 'react'
import { FacebookLogo, InstagramLogo, LinkedinLogo } from '@phosphor-icons/react'

import { AuthContext } from '../../contexts/AuthContext'

function Footer() {

    let data = new Date().getFullYear()

    const { usuario } = useContext(AuthContext)

    let component: ReactNode

    if (usuario.token !== "") {

        component = (
            <div className="flex justify-center bg-indigo-900 text-white">
                <div className="container flex flex-col items-center py-4">
                    <p className='text-xl font-bold'>
                        Blog Pessoal Generation | Copyright: { data }
                    </p>

                    <p className='text-lg'>Acesse nossas redes sociais</p>
                    <div className='flex gap-2'>
                        <LinkedinLogo size={48} weight='bold' />
                        <InstagramLogo size={48} weight='bold' />
                        <FacebookLogo size={48} weight='bold' />
                    </div>
                </div>
            </div>)
    }

    return (
        <>
            { component }
        </>
    )
}

export default Footer
```

<br>

<div align="center"><img src="https://i.imgur.com/dVRJoWB.png" title="source: imgur.com" /></div>

<br>

**Vamos analisar as altera칞칫es efetuadas no c칩digo:**

**Linha 01:** Fazemos a importa칞칚o da tipagem ReactNode, e do hook useContext da biblitoeca do react.

**Linha 10:** Importamos do Contexto o estado do usu치rio.

**Linha 12:** Adicionamos uma **vari치vel let chamada component**, que ser치 do tipo **ReactNode**, indicando que o valor desta vari치vel armazenar치 algo que possa ser renderizado pelo React. 

<br>

<div align="center"><img src="https://i.imgur.com/2NxGxBf.png" title="source: imgur.com" /></div>

<br>

**Linhas 14 a 31:** Adicionamos uma estrutura condicional **IF**, onde verificamos se o o token do estado usu치rio 칠 diferente de uma String vazia. Se esta condi칞칚o for verdadeira, isso indica que o usu치rio est치 logado.

**Linhas 16 a 30:** Se o usu치rio estiver logado, atualizamos a vari치vel componente com a estrutura do componente Footer, isto 칠, ao inv칠s de retornamos diretamente o que deve ser exibido em tela, passamos o c칩digo HTML/CSS para a vari치vel.

**Linhas 33 a 37:** Onde antes estava o c칩digo de exibi칞칚o do Footer, agora consta a vari치vel **component**. 

Com a mesma l칩gica que empregamos no componente Navbar, quando o token de usu치rio estiver preenchido apenas com uma String vazia, ser치 carregado em tela, mas estar치 vazio. A partir do momento que o token for preenchido, nossa estrutura condicional ir치 atualizar a vari치vel **component** com os c칩digos do Footer, e com isso, o mesmo ser치 exibido.

Com esses ajustes finalizados, agora iremos trabalhar os nossos alertas, os personalizando de acordo com o tipo de mensagem que queremos passar para o usu치rio.

<h2>游녺Passo 03 - Instala칞칚o da Biblioteca React-toastify</h2>

Primeiramente, vamos come칞ar adicionando a Biblioteca do Toastify para podermos personalizar os nossos alertas. Para isso, siga os passos abaixo.

1. No console do VsCode, insira o seguinte c칩digo:

```bash
yarn add react-toastify@^9.1.3
```

2. Ap칩s a instala칞칚o bem sucedida, ser치 exibida uma mensagem semelhante a esta imagem:

<br>

<div align="center"><img src="https://i.imgur.com/OWXtwW3.png" title="source: imgur.com" /></div>

<br>

<h2><img src="https://i.imgur.com/izFuHID.png" title="source: imgur.com" width="4%"/>Passo 04 - Configurando o Toastify dentro da Aplica칞칚o</h2>

Com a biblioteca instalada, iremos construir um arquivo que conter치 a l칩gica dos alertas personalizados, sendo invocados de acordo com o processo que est치 sendo utilizado. Ex.: em caso de uma solicita칞칚o bem sucedida, iremos chamar o alerta de sucesso. 

3. Para isso, clique na pastas **src** e crie uma p치gina chamada **utils**.
4. Dentro dela, crie um arquivo chamado **toastAlerta com a extens칚o .ts**.
5. No final do processo, voc칡 deve ter uma organiza칞칚o semelhante a esta:

<br>

<div align="center"><img src="https://i.imgur.com/TjqI8aU.png" title="source: imgur.com" /></div>

<br>

6. Dentro do arquivo, insira a seguinte l칩gica:

```ts
import { toast } from 'react-toastify';

export function toastAlerta(mensagem: string, tipo: string) {
    switch (tipo) {
            
        case 'sucesso':
            toast.success(mensagem, {
                position: 'top-right',
                autoClose: 2000,
                hideProgressBar: false,
                closeOnClick: true,
                pauseOnHover: false,
                draggable: false,
                theme: 'colored',
                progress: undefined,
            });
            break;

        case 'info':
            toast.info(mensagem, {
                position: 'top-right',
                autoClose: 2000,
                hideProgressBar: false,
                closeOnClick: true,
                pauseOnHover: false,
                draggable: false,
                theme: 'colored',
                progress: undefined,
            });
            break;

        case 'erro':
            toast.error(mensagem, {
                position: 'top-right',
                autoClose: 2000,
                hideProgressBar: false,
                closeOnClick: true,
                pauseOnHover: false,
                draggable: false,
                theme: 'colored',
                progress: undefined,
            });
            break;

        default:
            toast.info(mensagem, {
                position: 'top-right',
                autoClose: 2000,
                hideProgressBar: false,
                closeOnClick: true,
                pauseOnHover: false,
                draggable: false,
                theme: 'colored',
                progress: undefined,
            });
            break;
    }
}
```

<br>

<div align="center"><img src="https://i.imgur.com/osJKL5X.png" title="source: imgur.com" /></div>

<br>

**Vamos analisar as altera칞칫es efetuadas no c칩digo:**

**Linha 01:** Fazemos a importa칞칚o do Componente **toast** da biblioteca React-Toastify.

**Linhas 03 a 58:** Constru칤mos e exportamos uma fun칞칚o que encapsula a l칩gica para exibir notifica칞칫es toast em nossa  aplica칞칚o. Essa fun칞칚o ter치 dentro de sua l칩gica a estrutura de decis칚o **Switch/Case** onde, para cada **tipo de notifica칞칚o (sucesso, informa칞칚o, erro)** uma mensagem personalizada ser치 exibida, al칠m de uma notifica칞칚o padr칚o de informa칞칚o caso o tipo seja desconhecido. Em linhas gerais, esta fun칞칚o 칠 chamada com a mensagem e o tipo desejados para exibir a notifica칞칚o correspondente na interface do usu치rio.

**Linhas 04 a 57:** Montamos a estrutura do **Switch/Case** para determinar qual tipo de notifica칞칚o do toastfy deve ser exibido com base no valor **tipo** passado como par칙metro.

**Linhas 06 a 17:** Caso o valor dentro do par칙metro **tipo** seja igual a sucesso, iremos exibir o toast com as configura칞칫es de sucesso, atrav칠s da fun칞칚o de mesmo nome. Dentro dos par칡nteses dessa fun칞칚o, informamos as configura칞칫es de como e onde o alerta ir치 aparecer, junto com a **mensagem** a ser exibida.

<br>

<div align="center"><img src="https://i.imgur.com/3DHCTUh.png" title="source: imgur.com" /></div>

<br>

**Linhas 19 a 30:** Caso o valor dentro do par칙metro **tipo** seja igual a info, iremos exibir o toast com as configura칞칫es relacionadas a um alerta informativo, atrav칠s da fun칞칚o **info()**. Dentro dos par칡nteses dessa fun칞칚o, informamos as configura칞칫es de como e onde o alerta ir치 aparecer, junto com a **mensagem** a ser exibida.

**Linhas 32 a 43:** Caso o valor dentro do par칙metro **tipo** seja igual a erro, iremos exibir o toast com as configura칞칫es relacionadas a um alerta de erro, atrav칠s da fun칞칚o **error()**. Dentro dos par칡nteses dessa fun칞칚o, informamos as configura칞칫es de como e onde o alerta ir치 aparecer, junto com a **mensagem** a ser exibida.

<br>

<div align="center"><img src="https://i.imgur.com/C4zmMLQ.png" title="source: imgur.com" /></div>

<br>

**Linhas 45 a 56:** Seguindo a estrutura do Switch/Case, caso nenhum dos case sejam atingidos, precisamos disparar o bloco **default**. Com isso, dentro desse bloco de c칩digo, adicionamos outro toast com o m칠todo info().

<br>

7. Com o arquivo configurado, precisamos agora habilitar o **Toastify** dentro do projeto, para ser usado e acessado por todos os componentes da aplica칞칚o. Portanto, acesso o componente **App.tsx** para fazer uma 칰ltima atualiza칞칚o em seu corpo.
8. Com o App.tsx aberto, fa칞a as mudan칞as nos lugares informados;

```tsx
import { ToastContainer } from 'react-toastify';
...
import 'react-toastify/dist/ReactToastify.css';
...
 <ToastContainer />
```

<br>

<div align="center"><img src="https://i.imgur.com/6KC6GWu.png" title="source: imgur.com" /></div>

<br>

**Vamos analisar as altera칞칫es efetuadas no c칩digo:**

**Linha 03:** Fazemos a importa칞칚o do Componente **ToastContainer** da biblioteca React-Toastify.

**Linha 18:** Fazemos a importa칞칚o do CSS nativo da biblioteca React-Toastify. Sem essa linha de c칩digo, os seus alertas ficar칚o todos sem a devida configura칞칚o.

**Linha 23:** Adicionamos o Componente **ToastContainer** a nossa aplica칞칚o. Deste modo, todos os componentes da aplica칞칚o conseguiram acessar e usar o alerta personalizado. Sem ele, os alertas n칚o ir칚o aparecer.

<h2><img src="https://i.imgur.com/H9wEgsJ.png" title="source: imgur.com" width="5%"/>Passo 03 - Atualizando os alertas dos Componentes</h2>

Agora, iremos trocar os alertas padr칫es que estamos usando para os alertas personalizados.

1. Abra o componente **Cadastro.tsx**, que est치 dentro da pasta **pages**.
2. Em seguida, encontre o m칠todo **cadastrarNovoUsuario()** e, troque os alertas pelos c칩digos abaixo:

```tsx
async function cadastrarNovoUsuario(e: FormEvent<HTMLFormElement>) {
        e.preventDefault()

        if (confirmaSenha === usuario.senha && usuario.senha.length >= 8) {
            setIsLoading(true)

            try {
                await cadastrarUsuario(`/usuarios/cadastrar`, usuario, setUsuario)
                toastAlerta('Usu치rio cadastrado com sucesso', "sucesso")

            } catch (error) {
                toastAlerta('Erro ao cadastrar o Usu치rio', "erro")
            }

        } else {
            toastAlerta('Erro ao cadastrar o Usu치rio', "erro")
            setUsuario({ ...usuario, senha: "" })
            setConfirmaSenha("")
        }

        setIsLoading(false)
    }
```

<br>

<div align="center"><img src="https://i.imgur.com/gYqcqIZ.png" title="source: imgur.com" /></div>

<br>

<div align="center"><img src="https://i.imgur.com/xZex2t4.png" title="source: imgur.com" /></div>

<br>

**Vamos analisar as altera칞칫es efetuadas no c칩digo:**

**Linha 05:** Fazemos a importa칞칚o da fun칞칚o **toastAlerta** do arquivo que criamos.

**Linha 56:** Aqui, invocamos a fun칞칚o passando a mensagem a ser exibida, junto o tipo da mensagem.

**Linhas 60 e 65:** Adicionamos tamb칠m a fun칞칚o toastAlerta, substituindo o alerta anterior, passando a mensagem de erro a ser exibida, junto ao tipo da mensagem, informando que ela ser치 usada para mostrar um erro.

3. Muito bem, agora 칠 com voc칡! **Altere em todos os componentes que cont칡m os alertas padr칫es pelos alertas personalizados.**

Com essas altera칞칫es finalizadas, vamos testar nossa aplica칞칚o!

<h2><img src="https://i.imgur.com/H9wEgsJ.png" title="source: imgur.com" width="5%"/>Passo 04 - Testando o Componente</h2>

1. Execute o projeto atrav칠s do comando abaixo:

```bash
yarn dev
```

2. Pressione a tecla **o** do seu teclado para abrir o Projeto no Navegador.
3. Voc칡 ir치 perceber que o Navbar e o Footer n칚o est칚o aparecendo mais.

<div align="center"><img src="https://i.imgur.com/YLIeAch.png" title="source: imgur.com" /></div>

2. Com o projeto aberto, logue na aplica칞칚o e verifique a mensagem.

<br>

<div align="center"><img src="https://i.imgur.com/Myo8CM9.png" title="source: imgur.com" /></div>

<br>

Perceba que al칠m de aparecer um alerta personalizado, agora o Navbar e o Footer est칚o vis칤veis. 

3. Teste as funcionalidades de seu Blog e verifique se est칚o todas funcionando como esperado e com os alertas personalizados!
4. Agora, deslogue da aplica칞칚o.

<br>

<div align="center"><img src="https://i.imgur.com/Sdq8PQz.png" title="source: imgur.com" /></div>

<br>

<div align="left"><img src="https://i.imgur.com/izFuHID.png" title="source: imgur.com" width="5%"/> <a href="https://fkhadra.github.io/react-toastify/introduction" target="_blank"><b>Documenta칞칚o React Toastify</b></a></div>

<br>
<br>

<div align="left"><a href="README.md"><img src="https://i.imgur.com/XMgF3gl.png" title="source: imgur.com" width="3%"/>Voltar</a></div>
