<h1>Projeto Blog Pessoal - Implementando o Componente Card e Lista Temas</h1>

Com os componentes de Listagem constru√≠dos, agora iremos implementar sua l√≥gica e consumir os temas cadastrados em nosso Back End e exib√≠-los em nossa aplica√ß√£o.

Para isso, iremos consumir o endpoint **getAll** da nossa API, cujo a fun√ß√£o √© fornecer uma lista de todos os temas dispon√≠veis na aplica√ß√£o. Essa opera√ß√£o √© usada para listar temas cadastrados na base de dados, permitindo ao usu√°rio da API obter uma vis√£o geral dos temas dispon√≠veis e realizar a√ß√µes espec√≠ficas, como adicionar, atualizar ou remover.

<h2>üë£ Passo 01 - Cadastrar um Novo Tema</h2>

Nosso primeiro passo ser√° cadastrar um novo Tema em nossa API, para que quando o nosso componente de Listagem estiver totalmente implementado, podermos ter a certeza que sua l√≥gica foi adicionada corretamente.

1. Portanto, abra a sua aplica√ß√£o Back End em Deploy, acessando o caminho adicionado em sua Service. 
2. Ap√≥s a aplica√ß√£o ser exibida, voc√™ ver√° a tela do Swagger.
3. Encontre os recursos relacionados a Temas, e na rota de Cadastro de Temas (rota Post) **Cadastre um Novo Tema**.

<br>

IMAGEM PRINT 83

<br>

IMAGEM PRINT 84

<br>

<h2><img src="https://i.imgur.com/izFuHID.png" title="source: imgur.com" width="4%"/>Passo 02 - Atualizar a Classe de Servi√ßo - Service de Busca</h2>

Com pelos menos um tema cadastrado em nosso Back End, vamos partir agora para a constru√ß√£o da Service que ter√° a fun√ß√£o de Buscar os Temas e carreg√°-los em nosso Front End.

1. Vamos come√ßar adicionando a service de cadastro de usu√°rios. Portanto, abra o arquivo **Service.ts** localizado dentro da pasta **service**.
2. Abaixo da **Service de Cadastro de Usu√°rio**, adicione l√≥gica a seguir:

```ts
export const buscar = async (url: string, setDados: Function, header: Object) => {
    const resposta = await api.get(url, header)
    setDados(resposta.data)
}
```

IMAGEM PRINT 85

<br>

**Vamos analisar o nosso c√≥digo:**

**Linhas 17 a 20:** Constru√≠mos e exportamos a fun√ß√£o ass√≠ncrona chamada **buscar**, que ser√° respons√°vel por todas as opera√ß√µes relacionadas a busca de recursos em nossa aplica√ß√£o, ou seja, ao buscar Temas, Postagens e informa√ß√µes especificas de algum recurso, usaremos essa Service.

**Linha 17:** Essa Arrow function aceita tr√™s argumentos:

- **url:** √â uma string que representa o endpoint da API para onde a solicita√ß√£o GET ser√° feita. Essa URL ser√° anexada √† URL base definida anteriormente na inst√¢ncia do Axios (api).
- **setDados:** √â uma fun√ß√£o que ser√° usada para atualizar os dados na sua aplica√ß√£o com a resposta da solicita√ß√£o.
- **header:** √â um objeto que cont√©m um cabe√ßalho HTTP, como informa√ß√µes de autentica√ß√£o.

**Linha 18:** Esta linha faz uma solicita√ß√£o GET para a URL especificada no par√¢metro de mesmo nome usando a inst√¢ncia do Axios, **api**. Como essa Service ir√° buscar informa√ß√µes, n√£o enviamos dados a ela. Logo, o segundo par√¢metro que passamos para essa requisi√ß√£o √© o argumento **header**, que cont√©m o token do usu√°rio autenticado, permitindo o acesso dessa fun√ß√£o ao Back. A palavra reservada **await** √© usada para esperar a conclus√£o da solicita√ß√£o antes de continuarmos o fluxo da fun√ß√£o.

**Linha 19:** Ap√≥s a conclus√£o da solicita√ß√£o, a resposta da API √© armazenada na vari√°vel **resposta**. O c√≥digo ent√£o chama a fun√ß√£o **setDados**, passando **resposta.data como argumento**. Isso atualiza os dados na nossa aplica√ß√£o com os dados retornados pela API ap√≥s a busca bem-sucedida dos temas.

| [![source: imgur.com](https://camo.githubusercontent.com/656a7f920290b1249ff1f60c486fa6cb7ad1af445115fac67cf14a9abd41a208/68747470733a2f2f692e696d6775722e636f6d2f684f67577653632e706e67)](https://camo.githubusercontent.com/656a7f920290b1249ff1f60c486fa6cb7ad1af445115fac67cf14a9abd41a208/68747470733a2f2f692e696d6775722e636f6d2f684f67577653632e706e67) | **ATEN√á√ÉO:** *Observe que o c√≥digo da service Buscar possui algumas diferen√ßas em rela√ß√£o as services anteriores. A mais importante, √© o uso do par√¢metro HEADER. Esse par√¢metro ir√° conter o Token de Autentica√ß√£o do Usu√°rio, e DEVE ser passado a essa fun√ß√£o, j√° que as services que iremos construir daqui para frente, s√£o todas protegidas pela Security do Spring, e precisam do Token JWT para autorizar a execu√ß√£o de determinada fun√ß√£o.* |
| ------------------------------------------------------------ | ------------------------------------------------------------ |



<h2><img src="https://i.imgur.com/H9wEgsJ.png" title="source: imgur.com" width="5%"/>Passo 03 - Implementando a L√≥gica no Componente Card Temas</h2>

1. Abra o componente **CardTemas.tsx** localizado dentro da pasta **temas**.
2. Insira os c√≥digos abaixo, nos locais indicados:

<br>

```react
import { Link } from 'react-router-dom'
import Tema from '../../../models/Tema'

interface CardTemaProps {
    tema: Tema
}

function CardTemas({ tema }: CardTemaProps) {
    return (
        <div className='border flex flex-col rounded-2xl overflow-hidden justify-between'>
            <header className='py-2 px-6 bg-indigo-800 text-white font-bold text-2xl'>
                Tema
            </header>

            <p className='p-8 text-3xl bg-slate-200 h-full'>
                {tema.descricao}
            </p>

            <div className="flex">
                <Link to={`/editarTema/${tema.id}`}
                    className='w-full text-slate-100 bg-indigo-400 hover:bg-indigo-800 
                        flex items-center justify-center py-2'>
                    <button>Editar</button>
                </Link>

                <Link to={`/deletarTema/${tema.id}`}
                    className='text-slate-100 bg-red-400 hover:bg-red-700 w-full 
                        flex items-center justify-center'>
                    <button>Deletar</button>
                </Link>
            </div>

        </div>
    )
}

export default CardTemas
```

<br>

IMAGEM PRINT 86

<br>

**Vamos analisar o nosso c√≥digo:**

**Linha 02:** Fazemos a importa√ß√£o da Model de Temas, j√° que iremos trabalhar com Props.

**Linhas 04 a 06:** Estamos definindo uma interface chamada **CardTemaProps** que especifica as propriedades que co componente **CardTemas.tsx** espera receber. No caso, ele espera receber um Objeto que ser√° referenciado atrav√©s do nome **tema**, e seu formato deve seguir as propriedades da Model Tema, ou seja, que possua **ID e Descri√ß√£o.**

**Linha 08:** Ap√≥s definir a estrutura da Props desse componente, passamos sua propriedade para o componente usando a **Desestrutura√ß√£o**, acessando a propriedade tema diretamente.

**Linha 16:** Como cada Card ir√° ter uma descri√ß√£o para cada Tema, aqui deixamos o campo din√¢mico, passando para a Tag de Paragrafo a **descri√ß√£o** do Tema que foi enviado como uma propriedade para esse Card.

**Linhas 20 e 23:** Nessas linhas, o componente **Link** √© usado para criar um link para a p√°gina de edi√ß√£o e dele√ß√£o do tema atrav√©s de sua propriedade **to**. Atrav√©s dessa propriedade, definimos as rotas que ser√£o usadas nessas a√ß√µes, incluindo junto a elas o ID do tema em quest√£o. Isso se d√° pois, tanto na rota de dele√ß√£o e de edi√ß√£o que ser√£o constru√≠das futuramente, os componentes dessas rotas ir√£o acessar esse ID que veio pela URL e fazer uma requisi√ß√£o ao Back, para pegar os dados e executar suas respectivas fun√ß√µes.

<h2><img src="https://i.imgur.com/H9wEgsJ.png" title="source: imgur.com" width="5%"/>Passo 04 - Implementando a L√≥gica no Componente Lista Temas</h2>

Com a l√≥gica dos Cards implementadas, vamos ao Lista Temas.

1. Abra o componente **ListaTemas.tsx** localizado dentro da pasta **temas**.
2. Insira os c√≥digos abaixo, nos locais indicados:

<br>

```react
import { useContext, useEffect, useState } from 'react';
import { useNavigate } from 'react-router-dom';
import { Dna } from 'react-loader-spinner';

import { buscar } from '../../../services/Service';
import { AuthContext } from '../../../contexts/AuthContext';

import Tema from '../../../models/Tema';
import CardTemas from '../cardTemas/CardTemas';

function ListaTemas() {

    const [temas, setTemas] = useState<Tema[]>([]);

    let navigate = useNavigate();

    const { usuario, handleLogout } = useContext(AuthContext);
    const token = usuario.token;

    async function buscarTemas() {
        try {
            await buscar('/temas', setTemas, {
                headers: { Authorization: token },
            })
        } catch (error: any) {
            if (error.toString().includes('403')) {
                alert('O token expirou, favor logar novamente')
                handleLogout()
            }
        }
    }

    useEffect(() => {
        if (token === '') {
            alert('Voc√™ precisa estar logado');
            navigate('/login');
        }
    }, [token])

    useEffect(() => {
        buscarTemas()
    }, [temas.length])

    return (
```

<br>

```react
return (
        <>
            {temas.length === 0 && (
                <Dna
                    visible={true}
                    height="200"
                    width="200"
                    ariaLabel="dna-loading"
                    wrapperStyle={{}}
                    wrapperClass="dna-wrapper mx-auto"
                />
            )}

            <div className="flex justify-center w-full my-4">
                <div className="container flex flex-col">
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">

                        {temas.map((tema) => (
                            <>
                                <CardTemas key={tema.id} tema={tema} />
                            </>
                        ))}

                    </div>
                </div>
            </div>
        </>
    )
```

<br>

PRINT IMAGEM 87

<br>

**Vamos analisar o nosso c√≥digo:**

**Linhas 01 a 03:** 

**Linhas 05 a 06:**

**Linhas 08 a 09:**

**Linha 13:**

**Linha 15:**

**Linhas 17 a 18:**

**Linhas 20 a 32:**

**Linhas 21 a 24:**

**Linhas 26 a 31:**

**Linhas 34 a 39:**

**Linhas 41 a 43:**

**Linhas 47 a 56:**

**Linha 48:**

**Linhas 62 a 66:**

**Linha 64:**



<h2><img src="https://i.imgur.com/H9wEgsJ.png" title="source: imgur.com" width="5%"/>Passo 02 - Criando o Componente Lista Temas</h2>

Nossa p√°gina de Listagem de Temas, ter√° uma apar√™ncia semelhante com a imagem abaixo, j√° que ela pode alterar de acordo com a quantidade de Temas listados nelas. Ela ser√° respons√°vel por se conectar ao back-end e trazer os temas cadastrados, os exibindo usando o componente Card Tema.

IMAGEM DO LISTA TEMA PREENCHIDA

<br>

1. Dentro da pasta **temas**, crie outra pasta e a chame de **listaTemas**.
2. Dentro desta pasta, crie o arquivo **ListaTemas.tsx**. No final, voc√™ deve ter uma estrutura de p√°gina id√™ntica a imagem abaixo:

IMAGEM PRINT 72

3. Agora adicione os seguintes c√≥digo do Componente **ListaTemas**.

```react
import CardTemas from '../cardTemas/CardTemas';

function ListaTemas() {

    return (
        <>
            <div className="flex justify-center w-full my-4">
                <div className="container flex flex-col">
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                        <>
                            <CardTemas />
                        </>
                    </div>
                </div>
            </div>
        </>
    );
}

export default ListaTemas;
```

IMAGEM PRINT 73

COLOCAR INDICA√á√ïES DO TAILWIND

<h2><img src="https://i.imgur.com/H9wEgsJ.png" title="source: imgur.com" width="5%"/>Passo 03 - Atualiza√ß√£o das Rotas do Componente App</h2>

Vamos atualizar o Componente **App** de modo a exibir a nova p√°gina.

1. Abra o arquivo **App.tsx**, localizado na pasta **src**.
2. No local indicado, conforme indicado, insira a linha de c√≥digo:

```react
import ListaTemas from './components/temas/listaTemas/ListaTemas';
...
	<Route path="/temas" element={<ListaTemas />} />
```

IMAGEM PRINT 74

**Vamos analisar as altera√ß√µes efetuadas no c√≥digo:**

**Linha 09:** Fazemos a importa√ß√£o da p√°gina ListaTemas.

**Linha 22:** Usando o componente Route, adicionamos uma rota de acesso a nossa p√°gina, ou seja, toda vez que o usu√°rio acessar o caminho **/temas**, ser√° exibido a p√°gina de listagem de temas;

<h2><img src="https://i.imgur.com/H9wEgsJ.png" title="source: imgur.com" width="5%"/>Passo 04 - Atualiza√ß√£o do Componente Navbar</h2>

Para podemos acessar essa rota, vamos atualizar o componente Navbar adicionando a nova rota.

1. Abra o Componente Navbar localizado dentro da pasta **components**
2. Na sequ√™ncia, adicione a seguinte linha de c√≥digo no local indicado:

```react
<Link to='/temas' className='hover:underline'>Temas</Link>
```

IMAGEM PRINT 75

**Vamos analisar o nosso c√≥digo:**

**Linha 37:** Envolvemos o texto Temas em um componente Link, e passamos para a propriedade **to** a rota definida no componente App para abrir essa p√°gina, e tamb√©m uma classe do Tailwind. Quando o usu√°rio clicar nesse bot√£o, automaticamente ele ser√° redirecionado para a rota em quest√£o.

<h2><img src="https://i.imgur.com/H9wEgsJ.png" title="source: imgur.com" width="5%"/>Passo 05 - Testando o Componente</h2>

1. Execute o projeto atrav√©s do comando abaixo:

```bash
yarn dev
```

2. Pressione a tecla **o** do seu teclado para abrir o Projeto no Navegador
3. Com o projeto aberto, logue na aplica√ß√£o e depois clique no local indicado na imagem

IMAGEM PRINT 76

4. E ent√£o, voc√™ ser√° redirecionado a p√°gina de listagem de temas, com um card representando um tema trazido do Back End.

IMAGEM PRINT 77

<br /><br />

<div align="left"><a href="README.md"><img src="https://i.imgur.com/XMgF3gl.png" title="source: imgur.com" width="3%"/>Voltar</a></div>